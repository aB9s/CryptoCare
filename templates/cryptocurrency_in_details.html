<!DOCTYPE html>
<html lang="en">
 
<head>
    <title>{{currency.name}} Details</title>
     <link rel="shortcut icon" href="data:image/x-icon;," type="image/x-icon"> 
     
</head>
 
<body>
    <div class="container">
        <div>
            <h1>{{currency.name}} Details</h1>
            
            <ul>
                <li>Open: {{currency.cr_open}}</li>
                <li>Close: {{currency.cr_close}}</li>
                <li>High: {{currency.cr_high}}</li>
                <li>Low: {{currency.cr_low}}</li>
            </ul>
        </div>

        
        <div>
        <form>
        <button id="btn_graph" type="button">Graph</button>
        <button id="btn_history" type="button">History</button>
        <button id="btn_news" type="submit" value="{{currency.asset_id}}">News</button>
        <button id="btn_market" type="button" value="{{currency.asset_id}}" >market</button>
        <button id="btn_prediction" type="button" value="{{currency.asset_id}}">Prediction</button>
        <button id="btn_calculate" type="button">Calculate</button>
        </form>
        </div>
        
        <div>
            <div id="div_history"> </div>
            <div id="div_news" >
                <ul id="ul_news">
<!--
                    <li>
                        <img src="" style="width: 50px; height: 50px">
                        <title href=""></title>
                        <p></p>
                    </li>
-->
            </ul>
                </div>
            <div id="div_market">
                <ul>
                <li id='CHANGE24HOUR'></li>
                <li id='CHANGEDAY'></li>
                <li id='CHANGEPCT24HOUR'></li>
                <li id='CHANGEPCTDAY'></li>
                <li id='FROMSYMBOL'></li>
                <li id='HIGH24HOUR'></li>
                <li id='HIGHDAY'></li>
                <li id='LASTMARKET'></li>
                <li id='LASTTRADEID'></li>
                <li id='LASTUPDATE'></li>
                <li id='LASTVOLUME'></li>
                <li id='LASTVOLUMETO'></li>
                <li id='LOW24HOUR'></li>
                <li id='LOWDAY'></li>
                <li id='MARKET'></li>
                <li id='MKTCAP'></li>
                <li id='OPEN24HOUR'></li>
                <li id='OPENDAY'></li>
                <li id='PRICE'></li>
                <li id='SUPPLY'></li>
                <li id='TOSYMBOL'></li>
                <li id="TOTALVOLUME24H"></li>
                <li id="TOTALVOLUME24HTO"></li>
                <li id="VOLUME24HOUR"></li>
                <li id="VOLUME24HOURTO"></li>
                <li id="VOLUMEDAY"></li>
                <li id="VOLUMEDAYTO"></li>
                    
                    
                    
            </ul>
            </div>
            <div id="prediction">
                <h5 id='next_day'></h5>
                <h4 id='prediction_value'></h4>
            </div>
            <div id="div_calculator"></div>
        </div>
    </div>
    
    <script type=text/javascript>
  $SCRIPT_ROOT = {{ request.script_root|tojson|safe }};
</script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

    <script>window.jQuery || document.write('<script src="{{
  url_for('static', filename='jquery-3.3.1.js') }}">\x3C/script>')</script>
    <script>

     $(document).ready(function () {
         console.log("in document.ready")
    getNews();
         getmarketDetails();
         getMultipleSymbolPrice();
          getPrediction();
    });

      //News
  function getNews(){
      $.getJSON($SCRIPT_ROOT + '/news', {
        asset_id: $('#btn_news').val()
      }, function(data) {
           if( data[0].status =="success"){
               if(data[1].status=="ok"){
//                   articles = JSON.parse(data[1].articles)
//                   console.log(typeof(articles))
//                   console.log(articles)
                articles_list = data[1].articles
                   console.log(articles_list)
                   $('#ul_news').empty()
                   for(i =0;i< articles_list.length;i++){
                       article = articles_list[i]
                       console.log(article.author)
                      _li = '<li>'+
                       '<img src="'+article.urlToImage+'" style="width: 50px; height: 50px">'+
                        '<h3 href="'+article.url+'">'+article.title+'</h3>'+
                        '<h6>'+article.description+'</h6>'+
                        '</li>'
                       
                       $('#ul_news').append(_li)
            
                   }
               }
               
           }else{
           alert("Oops! Something went wrong.");
           }
      });
      return false;
  }
    
    //Market Details
  function getmarketDetails(){
  asset_id = $('#btn_market').val()
    
      $.getJSON($SCRIPT_ROOT + '/market_details', {
        asset_id: asset_id
      }, function(data) {
           if( data[0].status =="success"){
           display = data[1].DISPLAY[asset_id].USD
           console.log(display)
        document.getElementById('CHANGE24HOUR').innerHTML='CHANGE24HOUR: '+display.CHANGE24HOUR;
               document.getElementById('CHANGEDAY').innerHTML='CHANGEDAY: '+display.CHANGEDAY;
               document.getElementById('CHANGEPCT24HOUR').innerHTML='CHANGEPCT24HOUR: '+display.CHANGEPCT24HOUR;
               document.getElementById('CHANGEPCTDAY').innerHTML='CHANGEPCTDAY: '+display.CHANGEPCTDAY;
               document.getElementById('FROMSYMBOL').innerHTML='FROMSYMBOL: '+display.FROMSYMBOL;
               document.getElementById('HIGH24HOUR').innerHTML='HIGH24HOUR: '+display.HIGH24HOUR;
               document.getElementById('HIGHDAY').innerHTML='HIGHDAY: '+display.HIGHDAY;
               document.getElementById('LASTMARKET').innerHTML='LASTMARKET: '+display.LASTMARKET;
               document.getElementById('LASTTRADEID').innerHTML='LASTTRADEID: '+display.LASTTRADEID;
               document.getElementById('LASTUPDATE').innerHTML='LASTUPDATE: '+display.LASTUPDATE;
               document.getElementById('LASTVOLUME').innerHTML='LASTVOLUME: '+display.LASTVOLUME;
               document.getElementById('LASTVOLUMETO').innerHTML='LASTVOLUMETO: '+display.LASTVOLUMETO;
               document.getElementById('LOW24HOUR').innerHTML='LOW24HOUR: '+display.LOW24HOUR;
               document.getElementById('LOWDAY').innerHTML='LOWDAY: '+display.LOWDAY;
               document.getElementById('MARKET').innerHTML='MARKET: '+display.MARKET;
               document.getElementById('MKTCAP').innerHTML='MKTCAP: '+display.MKTCAP;
               document.getElementById('OPEN24HOUR').innerHTML='OPEN24HOUR: '+display.OPEN24HOUR;
               document.getElementById('OPENDAY').innerHTML='OPENDAY: '+display.OPENDAY;
               document.getElementById('PRICE').innerHTML='PRICE: '+display.PRICE;
               document.getElementById('SUPPLY').innerHTML='SUPPLY: '+display.SUPPLY;
               document.getElementById('TOSYMBOL').innerHTML='TOSYMBOL: '+display.TOSYMBOL;
               document.getElementById('TOTALVOLUME24H').innerHTML='TOTALVOLUME24H: '+display.TOTALVOLUME24H;
               document.getElementById('TOTALVOLUME24HTO').innerHTML='TOTALVOLUME24HTO: '+display.TOTALVOLUME24HTO;
               document.getElementById('VOLUME24HOUR').innerHTML='VOLUME24HOUR: '+display.VOLUME24HOUR;
               document.getElementById('VOLUME24HOURTO').innerHTML='VOLUME24HOURTO: '+display.VOLUME24HOURTO;
               document.getElementById('VOLUMEDAY').innerHTML='VOLUMEDAY: '+display.VOLUMEDAY;
               document.getElementById('VOLUMEDAYTO').innerHTML='VOLUMEDAYTO: '+display.VOLUMEDAYTO;
           }else{
           alert("Oops! Something went wrong.");
           }
      });
      return false;
    
  }

//Prediction
 function getPrediction() {
      $.getJSON($SCRIPT_ROOT + '/prediction', {
        asset_id: $('#btn_prediction').val()
      }, function(data) {
            console.log(data)
          var today = new Date()
          var tomorrow = new Date();
          tomorrow.setDate(today.getDate()+1);
          tomorrow_date = tomorrow.getMonth()+"/"+tomorrow.getDate()+"/"+tomorrow.getFullYear()
          document.getElementById('next_day').innerHTML = tomorrow_date
          document.getElementById('prediction_value').innerHTML = "Prediction: $"+data[1].prediction
      });
      return false;
    
  }


  function getMultipleSymbolPrice(){
      $.getJSON($SCRIPT_ROOT + '/multiple_symbol_price', {
        asset_id: $('#btn_prediction').val()
      }, function(data) {
          multiple_symbols_price_list = data[1]
           console.log(multiple_symbols_price_list)
          console.log(typeof multiple_symbols_price_list)
      });
      return false;
    
  }
        
        
     </script>

   </body>
</html>
